# 너의 MBTI는. : 텍스트를 통한 MBTI 예측

## 프로젝트 소개

텍스트를 통한 감정 분석 등은 자연어 처리 분야에서 대중적인 주제이지만, 텍스트 작성자의 성향까지 추측하려는 시도는 많지 않다. 비슷한 연구가 있는지 찾아본 결과, 한국어로 된 논문은 단 1개 밖에 없었다.

![image](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fr6TRz%2FbtsBiWHZkzA%2FLrOEDQ8ml0L91JbBxycnO1%2Fimg.png)

출처: 딥러닝 기반의 MBTI 성격유형 분류 연구 (김정민 외, 2022)

해당 한국어 논문은 0.2029 의 전체 정확도를 기록하였고, 해외에서 작성된 논문 중 가장 높은 성능을 보인 모델은 0.6659의 정확도를 기록하였다.

한국어 데이터셋으로도 조금 더 나은 성능의 분류모델을 만들 수 있을 것이라 생각하여 해당 프로젝트를 진행하게 되었다.

인공신경망 기반의 모델, 특히 자연어 처리에서 우수한 성능을 보이는 Transformer 를 사용하는 모델들을 사용하면 더 높은 정확도를 기록할 수 있을 것이라 생각했지만, 다른 연구들과 비교하기 위해 이를 사용하지 않았다.



## 문제 정의
입력값: 텍스트
예측값: 16개 class의 MBTI 유형 중 1개

위 문제를 풀 수 있는 방법은 크게 2가지 이다.

1. 다중 분류: 16개의 유형 중 1개를 예측
   
2. 4번의 이진 분류 후 예측값들을 결합: I/E, N/S, T/F, P/J 총 4개의 서브 태스크로 나눈 후, 각각의 예측값을 합치는 방식으로도 해결할 수 있다.

두 가지 방법을 전부 시도 해본 결과 다중 분류를 통한 예측이 결과가 더 좋았었다.



## 데이터 수집 및 전처리
지도학습을 위해서는 작성자의 mbti를 알 수 있는 텍스트가 필요한데, 네이버 mbti카페 에는 작성자들이 자신의 닉네임에 mbti를 표기한다는 점에 착안하여 이를 수집대상으로 정하였고, 총 24,286명이 작성한 555,415개의 글 및 댓글을 수집하였다.

먼저 수집한 게시글 및 댓글 중 양식이 지정되어 있는 게시글, 의미없는 댓글, 퍼온글 등을 제거하였다.

그 다음 일정 길이 이하의 글을 삭제하였다. 내용이 너무 짧을 시 성향을 유추하는 것이 의미가 없을 것이라 생각했기 때문이다.

마지막으로 게시글 및 댓글을 작성자별로 그룹화하였는데, 그 이유는 커뮤니티 특성 상 소수의 이용자가 대부분의 글을 작성하기 때문에 글 단위로 데이터를 학습하게 될 시 게시글을 많이 쓰는 이용자의 성향이 많이 반영될 것이라 판단했기 때문이다.

다양한 형태소 분석기 및 자연어 처리 방법론을 시도해본 결과, 최종적으로 Kiwi 라이브러리의 토크나이저를 통해 명사를 추출하고, tf-idf 방식으로 데이터를 처리하였을 때 결과가 가장 좋았다.



## 데이터 모델링
인공신경망 기반의 모델을 사용하지 않았다.
PyCaret을 이용하여 5개의 분류기(CatBoost, XGBoost, LightGBM, Gradient Boosting, Random Forest)를 앙상블한 모델을 최종 모델로 하였다.



## 평가
테스트 데이터에서 약 0.35의 정확도를 기록하여 기존 한국어 논문보다 더 높은 성능을 보이는데 성공하였으나, 더 개선할 필요가 있어보인다.
자연어 처리 분야에서 높은 성능을 보이는 Transformer 기반의 모델을 사용한다면 성능 향상이 일어날 것 이라 생각한다.

## Folder Structure
```
.
├── data
│   ├── data.csv
│   └── raw_data
│       └── ...
├── model.py
├── models
│   └── model.h5
├── README.md
├── requirements.txt
└── utils
    ├── add_dictionary.csv
    ├── erase_sentence.csv
    ├── erase_word.csv
    ├── exclude.csv
    ├── login.json
    ├── preprocess.py
    └── scrapper.py
```

## Requirements
```
pip install -r requirements.txt
```

TBA
